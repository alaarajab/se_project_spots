!function(){"use strict";var e="",t=e+"80804e27ce061efd1ffb.svg",r=e+"2fc47fd8e9a9bcd9612f.jpg",n=e+"49e44e5e03758262e8bf.svg",a=e+"975792ea68af0a3c209d.svg";const o={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},s=(e,t,r)=>{const n=e.querySelector(`#${t.id}-error`);n.textContent="",t.classList.remove(r.inputErrorClass),n.classList.remove(r.errorClass)},l=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?c(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},c=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},d=(e,t)=>{const r=Array.from(e.querySelectorAll(t.inputSelector));r.forEach((r=>{s(e,r,t)}));const n=e.querySelector(t.submitButtonSelector);l(r,n,t)};function i(e,t,r,n){e.textContent=t?n:r}document.getElementById("image-logo").src=t;const u=document.getElementById("image-avatar");u.src=r,document.getElementById("image-pencil").src=n,document.getElementById("image-plus").src=a;const m=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._handleResponse)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._handleResponse)}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then(this._handleResponse)}updateAvatarInfo(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._handleResponse)}addNewCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then(this._handleResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._handleResponse)}changeLikeStatus(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"PUT":"DELETE",headers:this._headers}).then(this._handleResponse)}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"e3c0228b-2422-4a4f-96fe-9e9c799fd017","Content-Type":"application/json"}});m.getAppInfo().then((e=>{let[t,r]=e;f.textContent=r.name,S.textContent=r.about,u.src=r.avatar,t.forEach((e=>{const t=G(e);w.append(t)}))})).catch(console.error);const _=document.querySelector(".profile__edit-btn"),h=document.querySelector(".profile__add-btn"),v=document.querySelector(".profile__avatar-btn"),f=document.querySelector(".profile__name"),S=document.querySelector(".profile__description"),y=document.querySelector("#edit-profile-modal"),p=y.querySelector(".modal__form"),b=y.querySelector(".modal__close"),q=y.querySelector("#profile-name-input"),E=y.querySelector("#profile-description-input"),g=document.querySelector("#preview-modal"),L=g.querySelector(".modal__image"),k=g.querySelector(".modal__caption"),C=g.querySelector(".modal__close_type_preview"),U=document.querySelector("#add-card-modal"),I=U.querySelector(".modal__form"),$=U.querySelector(".modal__submit-btn"),x=U.querySelector(".modal__close"),A=U.querySelector("#add-card-name-input"),B=U.querySelector("#add-card-link-input"),D=document.querySelector("#card-template"),w=document.querySelector(".cards__list"),R=document.querySelector("#update-avatar-modal"),T=R.querySelector(".modal__form"),N=R.querySelector(".modal__submit-btn"),P=R.querySelector(".modal__close"),j=R.querySelector("#profile-avatar-input"),O=document.querySelector("#delete-modal"),J=O.querySelector(".modal__form-del"),H=O.querySelector(".modal__close-del"),z=(O.querySelector(".modal__delete-btn"),O.querySelector(".modal__cancel-btn"));let M,F;function G(e){const t=D.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),n=t.querySelector(".card__image"),a=t.querySelector(".card__like-btn");return t.querySelector(".card__delete-btn").addEventListener("click",(()=>function(e,t){M=e,F=t,K(O)}(t,e._id))),r.textContent=e.name,n.src=e.link,n.alt=e.name,!0===e.isLiked&&a.classList.add("card__like-btn_liked"),a.addEventListener("click",(t=>{!function(e,t){const r=e.target,n=r.classList.contains("card__like-btn_liked");m.changeLikeStatus(t,!n).then((()=>{r.classList.toggle("card__like-btn_liked")})).catch(console.error)}(t,e._id)})),n.addEventListener("click",(()=>{K(g),L.src=e.link,L.alt=e.name,k.textContent=e.name})),t}function K(e){e.classList.add("modal_opened"),e.addEventListener("mousedown",X),document.addEventListener("keydown",Y)}function Q(e){e.classList.remove("modal_opened"),e.removeEventListener("mousedown",X),document.removeEventListener("keydown",Y)}function V(e){e.preventDefault();const t=e.submitter;i(t,!0,"Save","Saving..."),m.addNewCard({name:A.value,link:B.value}).then((e=>{const t=G(e);w.prepend(t),A.value="",B.value="",c($,o),Q(U)})).catch(console.error).finally((()=>{i(t,!1,"Save","Saving...")}))}var W;function X(e){e.target.classList.contains("modal_opened")&&Q(e.target)}function Y(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&Q(e)}}C.addEventListener("click",(()=>{Q(g)})),z.addEventListener("click",(()=>{Q(O)})),H.addEventListener("click",(()=>{Q(O)})),J.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;i(t,!0,"Delete","Deleting..."),m.deleteCard(F).then((()=>{M.remove(),Q(O)})).catch(console.error).finally((()=>{i(t,!1,"Delete","Deleting...")}))})),I.addEventListener("submit",V),_.addEventListener("click",(()=>{q.value=f.textContent,E.value=S.textContent,d(p,o),K(y)})),b.addEventListener("click",(()=>{Q(y)})),h.addEventListener("click",(()=>{d(I,o),K(U)})),x.addEventListener("click",(()=>{Q(U)})),p.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;i(t,!0,"Save","Saving..."),m.editUserInfo({name:q.value,about:E.value}).then((e=>{f.textContent=e.name,S.textContent=e.about,Q(y)})).catch(console.error).finally((()=>{i(t,!1,"Save","Saving...")}))})),I.addEventListener("submit",V),W=o,document.querySelectorAll(W.formSelector).forEach((e=>{((e,t)=>{const r=Array.from(e.querySelectorAll(t.inputSelector)),n=e.querySelector(t.submitButtonSelector);l(r,n,t),r.forEach((a=>{a.addEventListener("input",(function(){((e,t,r)=>{t.validity.valid?s(e,t,r):((e,t,r,n)=>{const a=e.querySelector(`#${t.id}-error`);a.textContent=r,t.classList.add(n.inputErrorClass),a.classList.add(n.errorClass)})(e,t,t.validationMessage,r)})(e,a,t),l(r,n,t)}))}))})(e,W)})),v.addEventListener("click",(()=>{d(T,o),K(R)})),P.addEventListener("click",(()=>{Q(R)})),T.addEventListener("submit",(function(e){e.preventDefault();const t=j.value.trim(),r=e.submitter;i(r,!0,"Save","Saving..."),m.updateAvatarInfo(t).then((e=>{u.src=e.avatar,Q(R)})).catch(console.error).finally((()=>{i(r,!1,"Save","Saving...")})),j.value="",c(N,o)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvdXRpbHMvaGVscGVycy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvdXRpbHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImV4cG9ydCBjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idG5cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnRuX2luYWN0aXZlXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JcIixcclxufTtcclxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBlcnJvck1zZywgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBlcnJvck1zZztcclxuICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgZXJyb3JNc2dFbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5lcnJvckNsYXNzKTtcclxufTtcclxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gIGVycm9yTXNnRWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuZXJyb3JDbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcclxuICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgIHNob3dJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSwgY29uZmlnKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpO1xyXG4gIH1cclxufTtcclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXQpID0+IHtcclxuICAgIHJldHVybiAhaW5wdXQudmFsaWRpdHkudmFsaWQ7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgZGlzYWJsZUJ1dHRvbihidXR0b25FbGVtZW50LCBjb25maWcpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBkaXNhYmxlQnV0dG9uID0gKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbn07XHJcbi8qY29uc3QgcmVzZXRWYWxpZGF0aW9uID0gKGZvcm1FbCwgaW5wdXRMaXN0LCBjb25maWcpID0+IHtcclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXQsIGNvbmZpZyk7XHJcbiAgfSk7XHJcbn07Ki9cclxuZXhwb3J0IGNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWwsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpKTtcclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXQsIGNvbmZpZyk7XHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWwucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTsgLy8gRW5zdXJlIGJ1dHRvbiBzdGF0ZSByZXNldHNcclxufTtcclxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsLCBjb25maWcpID0+IHtcclxuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcclxuXHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKTtcclxuXHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59O1xyXG5leHBvcnQgY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3Rvcik7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsKSA9PiB7XHJcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWwsIGNvbmZpZyk7XHJcbiAgfSk7XHJcbn07XHJcbiIsImV4cG9ydCBmdW5jdGlvbiBzZXRCdXR0b25UZXh0KGJ0biwgaXNMb2FkaW5nLCBkZWZhdWx0VGV4dCwgbG9hZGluZ1RleHQpIHtcclxuICBidG4udGV4dENvbnRlbnQgPSBpc0xvYWRpbmcgPyBsb2FkaW5nVGV4dCA6IGRlZmF1bHRUZXh0O1xyXG59XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBsb2dvU3JjIGZyb20gXCIuLi9pbWFnZXMvbG9nby5zdmdcIjtcclxuY29uc3QgbG9nb0ltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbWFnZS1sb2dvXCIpO1xyXG5sb2dvSW1hZ2Uuc3JjID0gbG9nb1NyYztcclxuaW1wb3J0IGF2YXRlclNyYyBmcm9tIFwiLi4vaW1hZ2VzL2F2YXRhci5qcGdcIjtcclxuY29uc3QgYXZhdGFySW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImltYWdlLWF2YXRhclwiKTtcclxuYXZhdGFySW1hZ2Uuc3JjID0gYXZhdGVyU3JjO1xyXG5cclxuaW1wb3J0IHBlbmNpbFNyYyBmcm9tIFwiLi4vaW1hZ2VzL3BlbmNpbC5zdmdcIjtcclxuY29uc3QgcGVuY2lsSW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImltYWdlLXBlbmNpbFwiKTtcclxucGVuY2lsSW1hZ2Uuc3JjID0gcGVuY2lsU3JjO1xyXG5pbXBvcnQgcGx1c1NyYyBmcm9tIFwiLi4vaW1hZ2VzL3BsdXMuc3ZnXCI7XHJcbmNvbnN0IHBsdXNJbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW1hZ2UtcGx1c1wiKTtcclxucGx1c0ltYWdlLnNyYyA9IHBsdXNTcmM7XHJcbmltcG9ydCB7XHJcbiAgZW5hYmxlVmFsaWRhdGlvbixcclxuICB2YWxpZGF0aW9uQ29uZmlnLFxyXG4gIHJlc2V0VmFsaWRhdGlvbixcclxuICBkaXNhYmxlQnV0dG9uLFxyXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcclxuaW1wb3J0IHsgc2V0QnV0dG9uVGV4dCB9IGZyb20gXCIuLi91dGlscy9oZWxwZXJzLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3V0aWxzL0FwaS5qc1wiO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiZTNjMDIyOGItMjQyMi00YTRmLTk2ZmUtOWU5Yzc5OWZkMDE3XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbi8vIEluaXRpYWwgZmV0Y2ggZm9yIGNhcmRzICsgdXNlclxyXG5hcGlcclxuICAuZ2V0QXBwSW5mbygpXHJcbiAgLnRoZW4oKFtjYXJkcywgdXNlckluZm9dKSA9PiB7XHJcbiAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXJJbmZvLm5hbWU7XHJcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VySW5mby5hYm91dDtcclxuICAgIGF2YXRhckltYWdlLnNyYyA9IHVzZXJJbmZvLmF2YXRhcjtcclxuXHJcbiAgICBjYXJkcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoaXRlbSk7XHJcbiAgICAgIGNhcmRzTGlzdC5hcHBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcblxyXG4vL3Byb2ZpbGUgZWxlbWVudHNcclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnRuXCIpO1xyXG5jb25zdCBjYXJkTW9kYWxCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idG5cIik7XHJcbmNvbnN0IGF2YXRhck1vZGFsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnRuXCIpO1xyXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcclxuLy9mb3JtIGVsZW1lbnRzXHJcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiKTtcclxuY29uc3QgZWRpdEZvcm1FbGVtZW50ID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5jb25zdCBlZGl0TW9kYWxDbG9zZUJ0biA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcbmNvbnN0IGVkaXRNb2RhbE5hbWVJbnB1dCA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLW5hbWUtaW5wdXRcIlxyXG4pO1xyXG5jb25zdCBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0ID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxyXG4pO1xyXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XHJcbmNvbnN0IHByZXZpZXdNb2RlbEltYWdlRWwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbmNvbnN0IHByZXZpZXdNb2RlbEljYXB0aW9uRWwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcclxuY29uc3QgcHJldmlld01vZGVsQ2xvc2VCdXR0b24gPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9fY2xvc2VfdHlwZV9wcmV2aWV3XCJcclxuKTtcclxuLy9jYXJkIHJlbGF0ZWQgZWxlbWVudHNcclxuY29uc3QgY2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcclxuY29uc3QgY2FyZEZvcm0gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgY2FyZFN1Ym1pdEJ0biA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xyXG5jb25zdCBjYXJkTW9kYWxDbG9zZUJ1dHRvbiA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuY29uc3QgY2FyZE5hbWVJbnB1dCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW5hbWUtaW5wdXRcIik7XHJcbmNvbnN0IGNhcmRMaW5rSW5wdXQgPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1saW5rLWlucHV0XCIpO1xyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XHJcbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcbi8vQXZhdGFyIGVsZW1lbnRzXHJcbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN1cGRhdGUtYXZhdGFyLW1vZGFsXCIpO1xyXG5jb25zdCBhdmF0YXJGb3JtID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgYXZhdGFyU3VibWl0QnRuID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ0blwiKTtcclxuY29uc3QgYXZhdGFyTW9kYWxDbG9zZUJ1dHRvbiA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xyXG5jb25zdCBhdmF0YXJMaW5rSW5wdXQgPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYXZhdGFyLWlucHV0XCIpO1xyXG5cclxuLy9kZWxldGUgbW9kb2xcclxuY29uc3QgZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1tb2RhbFwiKTtcclxuY29uc3QgZGVsZXRlRm9ybSA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm0tZGVsXCIpO1xyXG5jb25zdCBkZWxldE1vZGFsQ2xvc2VCdXR0b24gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1kZWxcIik7XHJcbmNvbnN0IGRlbGV0aW5nQnRuID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZGVsZXRlLWJ0blwiKTtcclxuY29uc3QgY2FuY2VsQnRuID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FuY2VsLWJ0blwiKTtcclxuXHJcbmxldCBzZWxlY3RlZENhcmQsIHNlbGVjdGVkQ2FyZElkO1xyXG5mdW5jdGlvbiBoYW5kZWxEZWxldGVTdWJtaXQoZSkge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuICBjb25zdCBzdWJtaXRCdG4gPSBlLnN1Ym1pdHRlcjtcclxuICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgdHJ1ZSwgXCJEZWxldGVcIiwgXCJEZWxldGluZy4uLlwiKTtcclxuICBhcGlcclxuICAgIC5kZWxldGVDYXJkKHNlbGVjdGVkQ2FyZElkKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XHJcbiAgICAgIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgZmFsc2UsIFwiRGVsZXRlXCIsIFwiRGVsZXRpbmcuLi5cIik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGVsRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgY2FyZElkKSB7XHJcbiAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XHJcbiAgc2VsZWN0ZWRDYXJkSWQgPSBjYXJkSWQ7XHJcbiAgb3Blbk1vZGFsKGRlbGV0ZU1vZGFsKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGVsTGlrZShlLCBpZCkge1xyXG4gIGNvbnN0IGxpa2VCdXR0b24gPSBlLnRhcmdldDtcclxuICBjb25zdCBpc0xpa2VkID0gbGlrZUJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKTtcclxuXHJcbiAgYXBpXHJcbiAgICAuY2hhbmdlTGlrZVN0YXR1cyhpZCwgIWlzTGlrZWQpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIGxpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcclxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gIGNvbnN0IGNhcmROYW1lRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gIGNvbnN0IGNhcmRJbWFnZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICBjb25zdCBjYXJkTGlrZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idG5cIik7XHJcbiAgY29uc3QgY2FyZERlbGV0ZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ0blwiKTtcclxuXHJcbiAgY2FyZERlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgIGhhbmRlbERlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEuX2lkKVxyXG4gICk7XHJcblxyXG4gIGNhcmROYW1lRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgY2FyZEltYWdlRWwuc3JjID0gZGF0YS5saW5rO1xyXG4gIGNhcmRJbWFnZUVsLmFsdCA9IGRhdGEubmFtZTtcclxuXHJcbiAgaWYgKGRhdGEuaXNMaWtlZCA9PT0gdHJ1ZSkge1xyXG4gICAgY2FyZExpa2VCdG4uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnRuX2xpa2VkXCIpO1xyXG4gIH1cclxuXHJcbiAgY2FyZExpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAvKiovXHJcbiAgICBoYW5kZWxMaWtlKGUsIGRhdGEuX2lkKTtcclxuICB9KTtcclxuXHJcbiAgY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xyXG4gICAgcHJldmlld01vZGVsSW1hZ2VFbC5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICBwcmV2aWV3TW9kZWxJbWFnZUVsLmFsdCA9IGRhdGEubmFtZTtcclxuICAgIHByZXZpZXdNb2RlbEljYXB0aW9uRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxucHJldmlld01vZGVsQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKHByZXZpZXdNb2RhbCk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGNsb3NlTW9kYWxPbk92ZXJsYXlDbGljayk7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VNb2RhbE9uRXNjYXBlKTtcclxufVxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICBtb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGNsb3NlTW9kYWxPbk92ZXJsYXlDbGljayk7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VNb2RhbE9uRXNjYXBlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRWRpdEZvcm1TdWJtaXQoZSkge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgY29uc3Qgc3VibWl0QnRuID0gZS5zdWJtaXR0ZXI7XHJcblxyXG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCB0cnVlLCBcIlNhdmVcIiwgXCJTYXZpbmcuLi5cIik7XHJcblxyXG4gIGFwaVxyXG4gICAgLmVkaXRVc2VySW5mbyh7XHJcbiAgICAgIG5hbWU6IGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZSxcclxuICAgICAgYWJvdXQ6IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWUsXHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKHVzZXJEYXRhKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcclxuICAgICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdXNlckRhdGEuYWJvdXQ7XHJcbiAgICAgIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCBmYWxzZSwgXCJTYXZlXCIsIFwiU2F2aW5nLi4uXCIpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoZSkge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuICBjb25zdCBzdWJtaXRCdG4gPSBlLnN1Ym1pdHRlcjtcclxuXHJcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIHRydWUsIFwiU2F2ZVwiLCBcIlNhdmluZy4uLlwiKTtcclxuICBhcGlcclxuICAgIC5hZGROZXdDYXJkKHsgbmFtZTogY2FyZE5hbWVJbnB1dC52YWx1ZSwgbGluazogY2FyZExpbmtJbnB1dC52YWx1ZSB9KVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsID0gZ2V0Q2FyZEVsZW1lbnQoZGF0YSk7IC8vIEFzc3VtZXMgZ2V0Q2FyZEVsZW1lbnQgaGFuZGxlcyBBUEkgcmVzcG9uc2Ugc2hhcGVcclxuICAgICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsKTtcclxuICAgICAgY2FyZE5hbWVJbnB1dC52YWx1ZSA9IFwiXCI7XHJcbiAgICAgIGNhcmRMaW5rSW5wdXQudmFsdWUgPSBcIlwiO1xyXG4gICAgICBkaXNhYmxlQnV0dG9uKGNhcmRTdWJtaXRCdG4sIHZhbGlkYXRpb25Db25maWcpO1xyXG4gICAgICBjbG9zZU1vZGFsKGNhcmRNb2RhbCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCBmYWxzZSwgXCJTYXZlXCIsIFwiU2F2aW5nLi4uXCIpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChlKSB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IGF2YXRhclVybCA9IGF2YXRhckxpbmtJbnB1dC52YWx1ZS50cmltKCk7XHJcbiAgY29uc3Qgc3VibWl0QnRuID0gZS5zdWJtaXR0ZXI7XHJcblxyXG4gIC8qaWYgKCFhdmF0YXJVcmwpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJBdmF0YXIgVVJMIGlzIGVtcHR5LlwiKTtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGNvbnNvbGUubG9nKFwiU3VibWl0dGluZyBhdmF0YXIgVVJMOlwiLCBhdmF0YXJVcmwpOyovXHJcblxyXG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCB0cnVlLCBcIlNhdmVcIiwgXCJTYXZpbmcuLi5cIik7XHJcblxyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZUF2YXRhckluZm8oYXZhdGFyVXJsKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgYXZhdGFySW1hZ2Uuc3JjID0gZGF0YS5hdmF0YXI7XHJcbiAgICAgIGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgZmFsc2UsIFwiU2F2ZVwiLCBcIlNhdmluZy4uLlwiKTtcclxuICAgIH0pO1xyXG5cclxuICBhdmF0YXJMaW5rSW5wdXQudmFsdWUgPSBcIlwiO1xyXG4gIGRpc2FibGVCdXR0b24oYXZhdGFyU3VibWl0QnRuLCB2YWxpZGF0aW9uQ29uZmlnKTtcclxufVxyXG5cclxuY2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XHJcbn0pO1xyXG5cclxuZGVsZXRNb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XHJcbn0pO1xyXG5cclxuZGVsZXRlRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRlbERlbGV0ZVN1Ym1pdCk7XHJcblxyXG5jYXJkRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUFkZENhcmRTdWJtaXQpO1xyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcclxuICBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xyXG5cclxuICByZXNldFZhbGlkYXRpb24oZWRpdEZvcm1FbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICBvcGVuTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XHJcbn0pO1xyXG5cclxuZWRpdE1vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xyXG59KTtcclxuXHJcbmNhcmRNb2RhbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHJlc2V0VmFsaWRhdGlvbihjYXJkRm9ybSwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcblxyXG4gIG9wZW5Nb2RhbChjYXJkTW9kYWwpO1xyXG59KTtcclxuXHJcbmNhcmRNb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY2xvc2VNb2RhbChjYXJkTW9kYWwpO1xyXG59KTtcclxuZWRpdEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRWRpdEZvcm1TdWJtaXQpO1xyXG5jYXJkRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUFkZENhcmRTdWJtaXQpO1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uQ29uZmlnKTtcclxuXHJcbmF2YXRhck1vZGFsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgcmVzZXRWYWxpZGF0aW9uKGF2YXRhckZvcm0sIHZhbGlkYXRpb25Db25maWcpO1xyXG5cclxuICBvcGVuTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG59KTtcclxuYXZhdGFyTW9kYWxDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG59KTtcclxuYXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUF2YXRhclN1Ym1pdCk7XHJcblxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsT25PdmVybGF5Q2xpY2soZSkge1xyXG4gIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikpIHtcclxuICAgIGNsb3NlTW9kYWwoZS50YXJnZXQpO1xyXG4gIH1cclxufVxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsT25Fc2NhcGUoZSkge1xyXG4gIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgY29uc3Qgb3BlbmVkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGlmIChvcGVuZWRNb2RhbCkge1xyXG4gICAgICBjbG9zZU1vZGFsKG9wZW5lZE1vZGFsKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiLy8gdXRpbHMvQXBpLmpzXHJcbi8vaHR0cHM6Ly9leGFtcGxlLmNvbS9teS1hdmF0YXIuanBnXHJcblxyXG5jbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgZ2V0QXBwSW5mbygpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0aWFsQ2FyZHMoKSwgdGhpcy5nZXRVc2VySW5mbygpXSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGFib3V0IH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVBdmF0YXJJbmZvKGF2YXRhclVybCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXI6IGF2YXRhclVybCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGFkZE5ld0NhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBsaW5rIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG4gIGRlbGV0ZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBjaGFuZ2VMaWtlU3RhdHVzKGNhcmRJZCwgaXNMaWtlZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBpc0xpa2VkID8gXCJQVVRcIiA6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcbiAgX2hhbmRsZVJlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEFwaTtcclxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJ2YWxpZGF0aW9uQ29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbCIsImlucHV0RWwiLCJjb25maWciLCJlcnJvck1zZ0VsIiwicXVlcnlTZWxlY3RvciIsImlkIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJzb21lIiwiaW5wdXQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiYWRkIiwicmVzZXRWYWxpZGF0aW9uIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJzZXRCdXR0b25UZXh0IiwiYnRuIiwiaXNMb2FkaW5nIiwiZGVmYXVsdFRleHQiLCJsb2FkaW5nVGV4dCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzcmMiLCJsb2dvU3JjIiwiYXZhdGFySW1hZ2UiLCJhdmF0ZXJTcmMiLCJwZW5jaWxTcmMiLCJwbHVzU3JjIiwiYXBpIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiYmFzZVVybCIsImhlYWRlcnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldEFwcEluZm8iLCJQcm9taXNlIiwiYWxsIiwiZ2V0SW5pdGlhbENhcmRzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsInRoZW4iLCJfaGFuZGxlUmVzcG9uc2UiLCJlZGl0VXNlckluZm8iLCJfcmVmMiIsIm5hbWUiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwidXBkYXRlQXZhdGFySW5mbyIsImF2YXRhclVybCIsImF2YXRhciIsImFkZE5ld0NhcmQiLCJfcmVmMyIsImxpbmsiLCJkZWxldGVDYXJkIiwiY2hhbmdlTGlrZVN0YXR1cyIsImNhcmRJZCIsImlzTGlrZWQiLCJyZXMiLCJvayIsImpzb24iLCJyZWplY3QiLCJzdGF0dXMiLCJhdXRob3JpemF0aW9uIiwiY2FyZHMiLCJ1c2VySW5mbyIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwiaXRlbSIsImNhcmRFbGVtZW50IiwiZ2V0Q2FyZEVsZW1lbnQiLCJjYXJkc0xpc3QiLCJhcHBlbmQiLCJjYXRjaCIsImNvbnNvbGUiLCJlcnJvciIsInByb2ZpbGVFZGl0QnV0dG9uIiwiY2FyZE1vZGFsQnV0dG9uIiwiYXZhdGFyTW9kYWxCdXR0b24iLCJlZGl0UHJvZmlsZU1vZGFsIiwiZWRpdEZvcm1FbGVtZW50IiwiZWRpdE1vZGFsQ2xvc2VCdG4iLCJlZGl0TW9kYWxOYW1lSW5wdXQiLCJlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0IiwicHJldmlld01vZGFsIiwicHJldmlld01vZGVsSW1hZ2VFbCIsInByZXZpZXdNb2RlbEljYXB0aW9uRWwiLCJwcmV2aWV3TW9kZWxDbG9zZUJ1dHRvbiIsImNhcmRNb2RhbCIsImNhcmRGb3JtIiwiY2FyZFN1Ym1pdEJ0biIsImNhcmRNb2RhbENsb3NlQnV0dG9uIiwiY2FyZE5hbWVJbnB1dCIsImNhcmRMaW5rSW5wdXQiLCJjYXJkVGVtcGxhdGUiLCJhdmF0YXJNb2RhbCIsImF2YXRhckZvcm0iLCJhdmF0YXJTdWJtaXRCdG4iLCJhdmF0YXJNb2RhbENsb3NlQnV0dG9uIiwiYXZhdGFyTGlua0lucHV0IiwiZGVsZXRlTW9kYWwiLCJkZWxldGVGb3JtIiwiZGVsZXRNb2RhbENsb3NlQnV0dG9uIiwiY2FuY2VsQnRuIiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJkYXRhIiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmROYW1lRWwiLCJjYXJkSW1hZ2VFbCIsImNhcmRMaWtlQnRuIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9wZW5Nb2RhbCIsImhhbmRlbERlbGV0ZUNhcmQiLCJfaWQiLCJhbHQiLCJlIiwibGlrZUJ1dHRvbiIsInRhcmdldCIsImNvbnRhaW5zIiwidG9nZ2xlIiwiaGFuZGVsTGlrZSIsIm1vZGFsIiwiY2xvc2VNb2RhbE9uT3ZlcmxheUNsaWNrIiwiY2xvc2VNb2RhbE9uRXNjYXBlIiwiY2xvc2VNb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJoYW5kbGVBZGRDYXJkU3VibWl0IiwicHJldmVudERlZmF1bHQiLCJzdWJtaXRCdG4iLCJzdWJtaXR0ZXIiLCJ2YWx1ZSIsImNhcmRFbCIsInByZXBlbmQiLCJmaW5hbGx5Iiwia2V5Iiwib3BlbmVkTW9kYWwiLCJ1c2VyRGF0YSIsInNldEV2ZW50TGlzdGVuZXJzIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1zZyIsInZhbGlkYXRpb25NZXNzYWdlIiwidHJpbSJdLCJzb3VyY2VSb290IjoiIn0=