!function(){"use strict";var e="",t=e+"d3610e9c6dce3cb370d8.svg",o=e+"2fc47fd8e9a9bcd9612f.jpg",n=e+"d38272e02bb4f1ab1c37.svg",r=e+"40608da7369d39bc1077.svg";const a={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},c=(e,t,o)=>{const n=e.querySelector(`#${t.id}-error`);n.textContent="",t.classList.remove(o.inputErrorClass),n.classList.remove(o.errorClass)},s=(e,t,o)=>{(e=>e.some((e=>!e.validity.valid)))(e)?l(t,o):(t.disabled=!1,t.classList.remove(o.inactiveButtonClass))},l=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},i=(e,t)=>{const o=Array.from(e.querySelectorAll(t.inputSelector));o.forEach((o=>{c(e,o,t)}));const n=e.querySelector(t.submitButtonSelector);s(o,n,t)};document.getElementById("image-logo").src=t,document.getElementById("image-avatar").src=o,document.getElementById("image-pencil").src=n,document.getElementById("image-plus").src=r;const d=document.querySelector(".profile__edit-btn"),u=document.querySelector(".profile__add-btn"),m=document.querySelector(".profile__name"),p=document.querySelector(".profile__description"),_=document.querySelector("#edit-profile-modal"),y=_.querySelector(".modal__form"),f=_.querySelector(".modal__close"),v=_.querySelector("#profile-name-input"),g=_.querySelector("#profile-description-input"),S=document.querySelector("#preview-modal"),b=S.querySelector(".modal__image"),q=S.querySelector(".modal__caption"),w=S.querySelector(".modal__close_type_preview"),h=document.querySelector("#add-card-modal"),E=h.querySelector(".modal__form"),k=h.querySelector(".modal__submit-btn"),L=h.querySelector(".modal__close"),C=h.querySelector("#add-card-name-input"),x=h.querySelector("#add-card-link-input"),B=document.querySelector("#card-template"),z=document.querySelector(".cards__list");function j(e){const t=B.content.querySelector(".card").cloneNode(!0),o=t.querySelector(".card__title"),n=t.querySelector(".card__image"),r=t.querySelector(".card__like-btn"),a=t.querySelector(".card__delete-btn");return o.textContent=e.name,n.src=e.link,n.alt=e.name,r.addEventListener("click",(()=>{r.classList.toggle("card__like-btn_liked")})),a.addEventListener("click",(()=>{t.remove()})),n.addEventListener("click",(()=>{A(S),b.src=e.link,b.alt=e.name,q.textContent=e.name})),t}function A(e){e.classList.add("modal_opened"),e.addEventListener("mousedown",G),document.addEventListener("keydown",M)}function I(e){e.classList.remove("modal_opened"),e.removeEventListener("mousedown",G),document.removeEventListener("keydown",M)}var D;function G(e){e.target.classList.contains("modal_opened")&&I(e.target)}function M(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&I(e)}}w.addEventListener("click",(()=>{I(S)})),d.addEventListener("click",(()=>{v.value=m.textContent,g.value=p.textContent,i(y,a),A(_)})),f.addEventListener("click",(()=>{I(_)})),u.addEventListener("click",(()=>{i(E,a),A(h)})),L.addEventListener("click",(()=>{I(h)})),y.addEventListener("submit",(function(e){e.preventDefault(),m.textContent=v.value,p.textContent=g.value,I(_)})),E.addEventListener("submit",(function(e){e.preventDefault();const t=j({name:C.value,link:x.value});z.prepend(t),C.value="",x.value="",l(k,a),I(h)})),[{name:"Val Thorens",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/1-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Restaurant terrace",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/2-photo-by-ceiline-from-pexels.jpg"},{name:"An outdoor cafe",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/3-photo-by-tubanur-dogan-from-pexels.jpg"},{name:"A very long bridge, over the forest and through the trees",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/4-photo-by-maurice-laschet-from-pexels.jpg"},{name:"Tunnel with morning light",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/5-photo-by-van-anh-nguyen-from-pexels.jpg"},{name:"Mountain house",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/6-photo-by-moritz-feldmann-from-pexels.jpg"},{name:"Golden Gate bridge",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/spots/7-photo-by-griffin-wooldridge-from-pexels.jpg"}].forEach((e=>{const t=j(e);z.append(t)})),D=a,document.querySelectorAll(D.formSelector).forEach((e=>{((e,t)=>{const o=Array.from(e.querySelectorAll(t.inputSelector)),n=e.querySelector(t.submitButtonSelector);s(o,n,t),o.forEach((r=>{r.addEventListener("input",(function(){((e,t,o)=>{t.validity.valid?c(e,t,o):((e,t,o,n)=>{const r=e.querySelector(`#${t.id}-error`);r.textContent=o,t.classList.add(n.inputErrorClass),r.classList.add(n.errorClass)})(e,t,t.validationMessage,o)})(e,r,t),s(o,n,t)}))}))})(e,D)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FBUyxXQS9DWG9CLEVBQUNyRixFQUFRQyxFQUFTQyxLQUN0Q0QsRUFBUWEsU0FBU0MsTUFHcEJoQixFQUFlQyxFQUFRQyxFQUFTQyxHQWpCYm9GLEVBQUN0RixFQUFRQyxFQUFTc0YsRUFBVXJGLEtBQ2pELE1BQU1DLEVBQWFILEVBQU9JLGNBQWMsSUFBSUgsRUFBUUksWUFDcERGLEVBQVdHLFlBQWNpRixFQUN6QnRGLEVBQVFNLFVBQVVZLElBQUlqQixFQUFPTCxpQkFDN0JNLEVBQVdJLFVBQVVZLElBQUlqQixFQUFPSixXQUFXLEVBV3pDd0YsQ0FBZXRGLEVBQVFDLEVBQVNBLEVBQVF1RixrQkFBbUJ0RixFQUc3RCxFQTJDSW1GLENBQW1CckYsRUFBUUMsRUFBU0MsR0FFcENPLEVBQWtCQyxFQUFXQyxFQUFlVCxFQUM5QyxHQUFFLEdBQ0YsRUFLQWtGLENBQWtCcEYsRUFBUUUsRUFBTyxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25Db25maWcgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ0blwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnRuX2luYWN0aXZlXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvclwiLFxufTtcbmNvbnN0IHNob3dJbnB1dEVycm9yID0gKGZvcm1FbCwgaW5wdXRFbCwgZXJyb3JNc2csIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBlcnJvck1zZztcbiAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICBlcnJvck1zZ0VsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmVycm9yQ2xhc3MpO1xufTtcbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbiAgZXJyb3JNc2dFbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5lcnJvckNsYXNzKTtcbn07XG5cbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xuICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICBzaG93SW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2UsIGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpO1xuICB9XG59O1xuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0KSA9PiB7XG4gICAgcmV0dXJuICFpbnB1dC52YWxpZGl0eS52YWxpZDtcbiAgfSk7XG59O1xuXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIH1cbn07XG5cbmV4cG9ydCBjb25zdCBkaXNhYmxlQnV0dG9uID0gKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbn07XG4vKmNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWwsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXQsIGNvbmZpZyk7XG4gIH0pO1xufTsqL1xuZXhwb3J0IGNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWwsIGNvbmZpZykgPT4ge1xuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXQsIGNvbmZpZyk7XG4gIH0pO1xuXG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWwucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7IC8vIEVuc3VyZSBidXR0b24gc3RhdGUgcmVzZXRzXG59O1xuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsLCBjb25maWcpID0+IHtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWwucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcikpO1xuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG5cbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpO1xuXG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gICAgfSk7XG4gIH0pO1xufTtcbmV4cG9ydCBjb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xuICBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3Rvcik7XG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbCkgPT4ge1xuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbCwgY29uZmlnKTtcbiAgfSk7XG59O1xuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCBsb2dvU3JjIGZyb20gXCIuLi9pbWFnZXMvbG9nby5zdmdcIjtcbmNvbnN0IGxvZ29JbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW1hZ2UtbG9nb1wiKTtcbmxvZ29JbWFnZS5zcmMgPSBsb2dvU3JjO1xuaW1wb3J0IGF2YXRlclNyYyBmcm9tIFwiLi4vaW1hZ2VzL2F2YXRhci5qcGdcIjtcbmNvbnN0IGF2YXRhckltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpbWFnZS1hdmF0YXJcIik7XG5hdmF0YXJJbWFnZS5zcmMgPSBhdmF0ZXJTcmM7XG5pbXBvcnQgcGVuY2lsU3JjIGZyb20gXCIuLi9pbWFnZXMvcGVuY2lsLnN2Z1wiO1xuY29uc3QgcGVuY2lsSW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImltYWdlLXBlbmNpbFwiKTtcbnBlbmNpbEltYWdlLnNyYyA9IHBlbmNpbFNyYztcbmltcG9ydCBwbHVzU3JjIGZyb20gXCIuLi9pbWFnZXMvcGx1cy5zdmdcIjtcbmNvbnN0IHBsdXNJbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW1hZ2UtcGx1c1wiKTtcbnBsdXNJbWFnZS5zcmMgPSBwbHVzU3JjO1xuaW1wb3J0IHtcbiAgZW5hYmxlVmFsaWRhdGlvbixcbiAgdmFsaWRhdGlvbkNvbmZpZyxcbiAgcmVzZXRWYWxpZGF0aW9uLFxuICBkaXNhYmxlQnV0dG9uLFxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5cbi8qaW1wb3J0IHRob3JlbnNJbWFnZSBmcm9tIFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8xLXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIjtcbmltcG9ydCB0ZXJyYWNlSW1hZ2UgZnJvbSBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMi1waG90by1ieS1jZWlsaW5lLWZyb20tcGV4ZWxzLmpwZ1wiO1xuaW1wb3J0IGNhZmVJbWFnZSBmcm9tIFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCI7XG5pbXBvcnQgYnJpZGdlSW1hZ2UgZnJvbSBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNC1waG90by1ieS1tYXVyaWNlLWxhc2NoZXQtZnJvbS1wZXhlbHMuanBnXCI7XG5pbXBvcnQgdHVubmVsSW1hZ2UgZnJvbSBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIjtcbmltcG9ydCBtb3VudGFpbkltYWdlIGZyb20gXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzYtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiO1xuaW1wb3J0IGdhdGVJbWFnZSBmcm9tIFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy83LXBob3RvLWJ5LWdyaWZmaW4td29vbGRyaWRnZS1mcm9tLXBleGVscy5qcGdcIjtcbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiVmFsIFRob3JlbnNcIixcbiAgICBsaW5rOiB0aG9yZW5zSW1hZ2UsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLFxuICAgIGxpbms6IHRlcnJhY2VJbWFnZSxcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQW4gb3V0ZG9vciBjYWZlXCIsXG4gICAgbGluazogY2FmZUltYWdlLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJBIHZlcnkgbG9uZyBicmlkZ2UsIG92ZXIgdGhlIGZvcmVzdCBhbmQgdGhyb3VnaCB0aGUgdHJlZXNcIixcbiAgICBsaW5rOiBicmlkZ2VJbWFnZSxcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVHVubmVsIHdpdGggbW9ybmluZyBsaWdodFwiLFxuICAgIGxpbms6IHR1bm5lbEltYWdlLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJNb3VudGFpbiBob3VzZVwiLFxuICAgIGxpbms6IG1vdW50YWluSW1hZ2UsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkdvbGRlbiBHYXRlIGJyaWRnZVwiLFxuICAgIGxpbms6IGdhdGVJbWFnZSxcbiAgfSxcbl07Ki9cbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiVmFsIFRob3JlbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMS1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8yLXBob3RvLWJ5LWNlaWxpbmUtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkFuIG91dGRvb3IgY2FmZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy80LXBob3RvLWJ5LW1hdXJpY2UtbGFzY2hldC1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVHVubmVsIHdpdGggbW9ybmluZyBsaWdodFwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy81LXBob3RvLWJ5LXZhbi1hbmgtbmd1eWVuLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJNb3VudGFpbiBob3VzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy82LXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiR29sZGVuIEdhdGUgYnJpZGdlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzctcGhvdG8tYnktZ3JpZmZpbi13b29sZHJpZGdlLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuXTtcbi8vcHJvZmlsZSBlbGVtZW50c1xuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnRuXCIpO1xuY29uc3QgY2FyZE1vZGFsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnRuXCIpO1xuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuLy9mb3JtIGVsZW1lbnRzXG5jb25zdCBlZGl0UHJvZmlsZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LXByb2ZpbGUtbW9kYWxcIik7XG5jb25zdCBlZGl0Rm9ybUVsZW1lbnQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBlZGl0TW9kYWxDbG9zZUJ0biA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG5jb25zdCBlZGl0TW9kYWxOYW1lSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiXG4pO1xuY29uc3QgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dCA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXG4pO1xuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xuY29uc3QgcHJldmlld01vZGVsSW1hZ2VFbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbmNvbnN0IHByZXZpZXdNb2RlbEljYXB0aW9uRWwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcbmNvbnN0IHByZXZpZXdNb2RlbENsb3NlQnV0dG9uID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19jbG9zZV90eXBlX3ByZXZpZXdcIlxuKTtcbi8vY2FyZCByZWxhdGVkIGVsZW1lbnRzXG5jb25zdCBjYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsXCIpO1xuY29uc3QgY2FyZEZvcm0gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGNhcmRTdWJtaXRCdG4gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ0blwiKTtcblxuY29uc3QgY2FyZE1vZGFsQ2xvc2VCdXR0b24gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG5jb25zdCBjYXJkTmFtZUlucHV0ID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbmFtZS1pbnB1dFwiKTtcbmNvbnN0IGNhcmRMaW5rSW5wdXQgPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1saW5rLWlucHV0XCIpO1xuXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICBjb25zdCBjYXJkTmFtZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgY29uc3QgY2FyZEltYWdlRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAvL3NlbGVjdCB0aGUgZWxlbWVudFxuICBjb25zdCBjYXJkTGlrZUJ0biA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idG5cIik7XG4gIGNvbnN0IGNhcmREZWxldGVCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idG5cIik7XG5cbiAgY2FyZE5hbWVFbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgY2FyZEltYWdlRWwuc3JjID0gZGF0YS5saW5rO1xuICBjYXJkSW1hZ2VFbC5hbHQgPSBkYXRhLm5hbWU7XG4gIC8vYWRkIHRoZSBldmVudCBsaXN0ZW5lclxuICBjYXJkTGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIC8vd3JpdGUgY29kZSB0aGF0IGhhbmRlbCB0aGUgZXZlbnRcbiAgICBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIik7XG4gIH0pO1xuICBjYXJkRGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gIH0pO1xuICBjYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xuICAgIHByZXZpZXdNb2RlbEltYWdlRWwuc3JjID0gZGF0YS5saW5rO1xuICAgIHByZXZpZXdNb2RlbEltYWdlRWwuYWx0ID0gZGF0YS5uYW1lO1xuICAgIHByZXZpZXdNb2RlbEljYXB0aW9uRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gIH0pO1xuXG4gIHJldHVybiBjYXJkRWxlbWVudDtcbn1cbnByZXZpZXdNb2RlbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwocHJldmlld01vZGFsKTtcbn0pO1xuXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBjbG9zZU1vZGFsT25PdmVybGF5Q2xpY2spO1xuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBjbG9zZU1vZGFsT25Fc2NhcGUpO1xufVxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICBtb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGNsb3NlTW9kYWxPbk92ZXJsYXlDbGljayk7XG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGNsb3NlTW9kYWxPbkVzY2FwZSk7XG59XG5mdW5jdGlvbiBoYW5kbGVFZGl0Rm9ybVN1Ym1pdChlKSB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWU7XG4gIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWU7XG5cbiAgY2xvc2VNb2RhbChlZGl0UHJvZmlsZU1vZGFsKTtcbn1cbi8qZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChlKSB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7IG5hbWU6IGNhcmROYW1lSW5wdXQudmFsdWUsIGxpbms6IGNhcmRMaW5rSW5wdXQudmFsdWUgfTtcbiAgY29uc3QgY2FyZEVsID0gZ2V0Q2FyZEVsZW1lbnQoaW5wdXRWYWx1ZXMpO1xuICBjYXJkc0xpc3QucHJlcGVuZChjYXJkRWwpO1xuICBjbG9zZU1vZGFsKGNhcmRNb2RhbCk7XG59Ki9cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoZSkge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IGlucHV0VmFsdWVzID0geyBuYW1lOiBjYXJkTmFtZUlucHV0LnZhbHVlLCBsaW5rOiBjYXJkTGlua0lucHV0LnZhbHVlIH07XG4gIGNvbnN0IGNhcmRFbCA9IGdldENhcmRFbGVtZW50KGlucHV0VmFsdWVzKTtcbiAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsKTtcbiAgY2FyZE5hbWVJbnB1dC52YWx1ZSA9IFwiXCI7IC8vIENsZWFyIG5hbWUgaW5wdXRcbiAgY2FyZExpbmtJbnB1dC52YWx1ZSA9IFwiXCI7IC8vIENsZWFyIGxpbmsgaW5wdXRcbiAgLyplLnRhcmdldC5yZXN0KCk7Ki9cbiAgZGlzYWJsZUJ1dHRvbihjYXJkU3VibWl0QnRuLCB2YWxpZGF0aW9uQ29uZmlnKTtcbiAgY2xvc2VNb2RhbChjYXJkTW9kYWwpO1xufVxuXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcbiAgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcbiAgLypyZXNldFZhbGlkYXRpb24oZWRpdEZvcm1FbGVtZW50LCBbXG4gICAgZWRpdE1vZGFsTmFtZUlucHV0LFxuICAgIGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQsXG4gIF0pOyovXG4gIHJlc2V0VmFsaWRhdGlvbihlZGl0Rm9ybUVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpO1xuICBvcGVuTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XG59KTtcbmVkaXRNb2RhbENsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XG59KTtcblxuY2FyZE1vZGFsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIC8vZWRpdE1vZGFsTmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XG4gIC8vZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcbiAgLyogcmVzZXRWYWxpZGF0aW9uKGNhcmRGb3JtLCBbY2FyZE5hbWVJbnB1dCwgY2FyZExpbmtJbnB1dF0pOyovXG4gIHJlc2V0VmFsaWRhdGlvbihjYXJkRm9ybSwgdmFsaWRhdGlvbkNvbmZpZyk7XG5cbiAgb3Blbk1vZGFsKGNhcmRNb2RhbCk7XG59KTtcbmNhcmRNb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwoY2FyZE1vZGFsKTtcbn0pO1xuZWRpdEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRWRpdEZvcm1TdWJtaXQpO1xuY2FyZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcblxuLy9mb3IgKGxldCBpID0gMDsgaSA8IGluaXRpYWxDYXJkcy5sZW5ndGg7IGkrKykge1xuLy8gY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChpbml0aWFsQ2FyZHNbaV0pO1xuLy9jYXJkc0xpc3QucHJlcGVuZChjYXJkRWxlbWVudCk7XG4vL31cbmluaXRpYWxDYXJkcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoaXRlbSk7XG4gIGNhcmRzTGlzdC5hcHBlbmQoY2FyZEVsZW1lbnQpO1xufSk7XG5lbmFibGVWYWxpZGF0aW9uKHZhbGlkYXRpb25Db25maWcpO1xuXG5mdW5jdGlvbiBjbG9zZU1vZGFsT25PdmVybGF5Q2xpY2soZSkge1xuICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpKSB7XG4gICAgY2xvc2VNb2RhbChlLnRhcmdldCk7XG4gIH1cbn1cbmZ1bmN0aW9uIGNsb3NlTW9kYWxPbkVzY2FwZShlKSB7XG4gIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgIGNvbnN0IG9wZW5lZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XG4gICAgaWYgKG9wZW5lZE1vZGFsKSB7XG4gICAgICBjbG9zZU1vZGFsKG9wZW5lZE1vZGFsKTtcbiAgICB9XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwidmFsaWRhdGlvbkNvbmZpZyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWwiLCJpbnB1dEVsIiwiY29uZmlnIiwiZXJyb3JNc2dFbCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsInRleHRDb250ZW50IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50Iiwic29tZSIsImlucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsImFkZCIsInJlc2V0VmFsaWRhdGlvbiIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInNyYyIsImxvZ29TcmMiLCJhdmF0ZXJTcmMiLCJwZW5jaWxTcmMiLCJwbHVzU3JjIiwicHJvZmlsZUVkaXRCdXR0b24iLCJjYXJkTW9kYWxCdXR0b24iLCJwcm9maWxlTmFtZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsImVkaXRQcm9maWxlTW9kYWwiLCJlZGl0Rm9ybUVsZW1lbnQiLCJlZGl0TW9kYWxDbG9zZUJ0biIsImVkaXRNb2RhbE5hbWVJbnB1dCIsImVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQiLCJwcmV2aWV3TW9kYWwiLCJwcmV2aWV3TW9kZWxJbWFnZUVsIiwicHJldmlld01vZGVsSWNhcHRpb25FbCIsInByZXZpZXdNb2RlbENsb3NlQnV0dG9uIiwiY2FyZE1vZGFsIiwiY2FyZEZvcm0iLCJjYXJkU3VibWl0QnRuIiwiY2FyZE1vZGFsQ2xvc2VCdXR0b24iLCJjYXJkTmFtZUlucHV0IiwiY2FyZExpbmtJbnB1dCIsImNhcmRUZW1wbGF0ZSIsImNhcmRzTGlzdCIsImdldENhcmRFbGVtZW50IiwiZGF0YSIsImNhcmRFbGVtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmROYW1lRWwiLCJjYXJkSW1hZ2VFbCIsImNhcmRMaWtlQnRuIiwiY2FyZERlbGV0ZUJ0biIsIm5hbWUiLCJsaW5rIiwiYWx0IiwiYWRkRXZlbnRMaXN0ZW5lciIsInRvZ2dsZSIsIm9wZW5Nb2RhbCIsIm1vZGFsIiwiY2xvc2VNb2RhbE9uT3ZlcmxheUNsaWNrIiwiY2xvc2VNb2RhbE9uRXNjYXBlIiwiY2xvc2VNb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJrZXkiLCJvcGVuZWRNb2RhbCIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJjYXJkRWwiLCJwcmVwZW5kIiwiaXRlbSIsImFwcGVuZCIsInNldEV2ZW50TGlzdGVuZXJzIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1zZyIsInZhbGlkYXRpb25NZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==